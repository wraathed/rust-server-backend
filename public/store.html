<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Classic Rust - Store</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <a href="index.html" class="logo"><img src="assets/logo.png" alt="Classic Rust Logo"></a>
         <div class="menu-toggle">
        <span></span>
        <span></span>
        <span></span>
    </div>
        <nav>
            <ul>
                <li><a href="servers.html">Servers</a></li>
                <li><a href="store.html">Store</a></li>
                <li><a href="create-ticket.html">Create a Ticket</a></li>
                <li><a href="profile.html">My Profile</a></li>
            </ul>
        </nav>
       <div id="auth-section">
            <a href="/auth/steam" class="steam-login">
                <img src="assets/steam.png" alt="Steam">
                Sign in with Steam
            </a>
        </div>
    </header>
    
    <div class="container">
        <h2 style="text-align: center; border: none;">Store Packages</h2>
        
        <!-- NEW: GEM TEST SYSTEM -->
        <div style="background: rgba(0, 0, 0, 0.4); padding: 25px; border-radius: 8px; text-align: center; margin-bottom: 40px; border: 1px solid #444; max-width: 600px; margin-left: auto; margin-right: auto;">
            <h3 style="color: #00bcd4; margin-top: 0; text-transform: uppercase; letter-spacing: 1px;">ðŸ’Ž Gem Balance</h3>
            
            <div style="font-size: 32px; font-weight: bold; margin: 15px 0;">
                <span id="gem-balance-display" style="color: white;">---</span> 
                <span style="font-size: 16px; color: #888;">GEMS</span>
            </div>

            <p style="color: #aaa; font-size: 14px; margin-bottom: 20px;">
                Use the button below to simulate a payment. <br>Then type <b>/shop</b> in-game to spend them.
            </p>

            <button id="btn-add-gems" class="btn btn-primary" style="background-color: #00bcd4; border-color: #00bcd4; color: black; font-weight: bold; width: auto; padding: 10px 30px;">
                TEST: Add 500 Gems
            </button>
        </div>
        <!-- END GEM TEST SYSTEM -->

        <p style="text-align: center; color: #aaa; margin-bottom: 40px;">Select a package to enhance your experience.</p>
        
        <div class="store-grid">
            <div class="card">
                <h3 style="color: #aaa;">VIP</h3>
                <p>Perfect for casual players.<br><br>â€¢ Skip Queue<br>â€¢ Skinbox Access<br>â€¢ 2x Kits</p>
                <h4>\$10.00 <span style="font-size: 14px; color: #666;">/ mo</span></h4>
                <a href="#" class="btn btn-primary" style="background-color: transparent; border: 1px solid var(--primary-orange); color: var(--primary-orange);">Buy Now</a>
            </div>

            <div class="card featured">
                <div style="position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: var(--primary-orange); color: black; padding: 2px 10px; font-size: 10px; font-weight: bold; border-radius: 4px; text-transform: uppercase;">Most Popular</div>
                <h3 style="color: var(--primary-orange);">MVP</h3>
                <p>The best value for serious players.<br><br>â€¢ <b>All VIP Perks</b><br>â€¢ Priority Support<br>â€¢ Exclusive Discord Role<br>â€¢ Furnace Splitter</p>
                <h4>\$25.00 <span style="font-size: 14px; color: #666;">/ mo</span></h4>
                <a href="#" class="btn btn-primary">Buy Now</a>
            </div>

            <div class="card">
                <h3 style="color: #e74c3c;">Elite</h3>
                <p>Ultimate status and dominance.<br><br>â€¢ <b>All MVP Perks</b><br>â€¢ Custom Chat Tag<br>â€¢ Reserved Slot<br>â€¢ Sign Artist</p>
                <h4>\$50.00 <span style="font-size: 14px; color: #666;">/ lifetime</span></h4>
                <a href="#" class="btn btn-primary" style="background-color: transparent; border: 1px solid var(--primary-orange); color: var(--primary-orange);">Buy Now</a>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-left">
                <p>&copy; 2026 Classic Rust. All rights reserved.</p>
                <p class="credits">Designed by <a href="https://aetheriwebdesign.com/" target="_blank">Aetheri Web Design</a></p>
            </div>
            <div class="footer-right">
                <a href="#">Terms of Service</a>
                <a href="#">Privacy Policy</a>
                <a href="https://discord.gg/QdQUvPvg" class="btn btn-discord-small">
                    <img src="assets/discord.png" alt="Discord" style="width: 20px; height: 20px;">
                    Join Discord
                </a>
            </div>
        </div>
    </footer>

    <script src="auth.js"></script>
    <script src="loader.js"></script>
    <script src="mobile.js"></script>

    <!-- GEM SYSTEM SCRIPT -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const balanceDisplay = document.getElementById('gem-balance-display');
            const btnAdd = document.getElementById('btn-add-gems');

            // 1. Get current balance
            fetch('/user')
            .then(r => r.json())
            .then(user => {
                if(user && user.id) {
                    balanceDisplay.innerText = user.gems || 0;
                } else {
                    balanceDisplay.innerText = "?";
                    btnAdd.innerText = "Login to Test";
                    btnAdd.disabled = true;
                    btnAdd.style.opacity = "0.5";
                    btnAdd.style.cursor = "not-allowed";
                }
            })
            .catch(err => console.error("Error fetching user", err));

            // 2. Handle Add Gems Click
            if(btnAdd) {
                btnAdd.addEventListener('click', () => {
                    // Disable button to prevent spam
                    btnAdd.disabled = true;
                    btnAdd.innerText = "Processing...";

                    fetch('/api/gems/test-add', { method: 'POST' })
                    .then(r => r.json())
                    .then(data => {
                        if(data.success) {
                            alert(data.message);
                            location.reload(); // Refresh to show new balance
                        } else {
                            alert("Error: " + (data.error || "Unknown error"));
                            btnAdd.disabled = false;
                            btnAdd.innerText = "TEST: Add 500 Gems";
                        }
                    })
                    .catch(err => {
                        console.error(err);
                        alert("Network error occurred.");
                        btnAdd.disabled = false;
                        btnAdd.innerText = "TEST: Add 500 Gems";
                    });
                });
            }
        });
    </script>
</body>
</html>