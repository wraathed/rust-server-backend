<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Classic Rust - Servers</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <a href="index.html" class="logo"><img src="assets/logo.png" alt="Classic Rust Logo"></a>
         <div class="menu-toggle">
        <span></span>
        <span></span>
        <span></span>
    </div>
        <nav>
            <ul>
                <li><a href="servers.html">Servers</a></li>
                <li><a href="store.html">Store</a></li>
                <li><a href="create-ticket.html">Create a Ticket</a></li>
                <li><a href="profile.html">My Profile</a></li>
            </ul>
        </nav>
        <div id="auth-section">
            <a href="/auth/steam" class="steam-login">
                <img src="assets/steam.png" alt="Steam">
                Sign in with Steam
            </a>
        </div>
    </header>

    <div class="container">
        <h2>Server List</h2>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Status</th>
                        <th>Server Name</th>
                        <th>Map</th>
                        <th>Players</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="server-table-body">
                    <tr><td colspan="5" style="text-align:center; padding:20px;">Pinging Servers...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-left">
                <p>&copy; 2026 Classic Rust. All rights reserved.</p>
                <p class="credits">Designed by <a href="https://aetheriwebdesign.com/" target="_blank">Aetheri Web Design</a></p>
            </div>
            <div class="footer-right">
                <a href="#">Terms of Service</a>
                <a href="#">Privacy Policy</a>
                <a href="https://discord.gg/QdQUvPvg" class="btn btn-discord-small">
                    <img src="assets/discord.png" alt="Discord" style="width: 20px; height: 20px;">
                    Join Discord
                </a>
            </div>
        </div>
    </footer>

    <script src="auth.js"></script>
    <script src="loader.js"></script>
    <script src="mobile.js"></script>
    <script>
        const API_BASE = '';

        fetch(`${API_BASE}/api/servers`)
            .then(res => res.json())
            .then(servers => {
                const tbody = document.getElementById('server-table-body');
                tbody.innerHTML = '';

                if(servers.length === 0) {
                     tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">No servers online.</td></tr>';
                     return;
                }

                servers.forEach(server => {
                    const isOnline = server.status === 'Online';
                    const fullIp = `${server.ip}:${server.port}`;
                    
                    const row = `
                        <tr>
                            <td style="color: ${isOnline ? '#2ecc71' : '#ff4444'}; font-weight: bold;">
                                ${server.status}
                            </td>
                            <td>${server.name}</td>
                            <td>${server.map}</td>
                            <td>${isOnline ? `${server.players}/${server.maxPlayers}` : '-'}</td>
                            <td>
                                <button onclick="copyToClipboard('client.connect ${fullIp}')" class="btn btn-primary" style="padding: 5px 15px; font-size: 12px;">
                                    Copy IP
                                </button>
                            </td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
            });

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('IP Copied: ' + text);
            }).catch(err => {
                console.error('Failed to copy: ', err);
            });
        }
    </script>
</body>
</html>